---
title: "Simple Linear Model"
author: "Boyko Amarov"
date: "3/28/2022"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
invoices <- read.delim('https://raw.githubusercontent.com/feb-uni-sofia/econometrics2020-solutions/master/data/invoices.txt')
```


```{r}
glimpse(invoices)
```

Variablenbeschreibung:

- `Day` (numeric): Tag
- `Invoices` (numeric): Anzahl von Rechnungen
- `Time` (numeric): Bearbeitungszeit (Stunden)

Unsere Aufgabe ist, die Bearbeitungszeit für 50, 120, 201, 250 und 400 Rechnungen zu schätzen.

```{r}
ggplot(data = invoices, aes(x = Invoices, y = Time)) + 
  geom_point() +
  geom_vline(xintercept = c(50, 120, 201, 250, 400), lty = 2, alpha = 0.5) +
  scale_x_continuous(breaks = c(50, 120, 201, 250, 400)) +
  geom_abline(slope = 0.015, intercept = 0.1) +
  ylim(c(0, 7)) +
  geom_abline(slope = 0.001, intercept = 0.1, color = "firebrick")

# +
  # geom_vline(xintercept = 120, lty = 2) +
  # geom_hline(yintercept = 2.110) +
  # geom_abline(intercept = 0.1, slope = 0.015, colour = "steelblue2")
```

<!-- Estimate the expected processing time for 50, 120, 201, 250, 400 invoices (3 estimates). -->

<!-- Strategy 1: Use the average processing time for the predictions -->

$$
i = 1,\ldots,n = 30\\
x_i: \text{ Anzahl von Rechnungen an Tag } i \\
y_i: \text{ Bearbeitungszeit an Tag } i \\
$$
Angenommen, die Beziehung zwischen $y_i$ und $x_i$ die folgende Regel befolgt.

$$
y_i = 0.1 + 0.015x_i
$$
Diese Gleichung ist zu restriktiv, um die beobachteten Bearbeitungszeiten zu beschreiben. Wir erweitern sie um einen Zufallsterm (Störterme) $u_i$.

$$
y_i = 0.1 + 0.015x_i + u_i
$$

1) Wir nehmen an, daß die Terme $u_i$ normalverteilt mit Erwartungswert 0 und Varianz $\sigma^2$ sind.

$$
u_i \sim N(0, \sigma^2)
$$

2) Die Terme $u_i$ sind voneinander unabhängig.

$$
E(y_i) = E(0.1 + 0.015x_i + u_i)\\
E(y_i) = E(0.1) + E(0.015x_i) + E(u_i) \\
E(y_i) = 0.1 + 0.015x_i + 0 \\
E(y_i) = 0.1 + 0.015x_i
$$
The _expected_ processing time $E(y_i|x_i)$ is equal to $0.1 + 0.015x_i$.

$$
y_i = \underbrace{0.1 + 0.015x_i}_{\text{Systematic part}} + \underbrace{u_i}_{\text{Random part}}
$$

## Simulation

Normal distribution

```{r}
# r: random (zufällig), norm: normal (Normalverteilung)
# mean: Erwartungswert der Verteilung, 
# sd: Standardabweichung der Verteilung = Quadratische Wurzel aus der Varianz

u <- rnorm(1000, mean = 0, sd = 1)
# u
```




```{r}
tibble(u) %>%
  ggplot(aes(x = u)) +
    geom_histogram(bins = 30)
```


```{r}
n <- 30
x <- round(seq(10, 250, length.out = n), 0)
## Select values at random from a standard 
## normal distribution, i.e. mean = 0, standard dev. = 0.5
u <- rnorm(n, mean = 0, sd = 0.5)
y <- 0.1 + 0.015 * x + u

tibble(x = x, y = y) %>%
  ggplot(aes(x = x, y = y)) + 
    geom_point() +
    geom_abline(intercept = 0.1, slope = 0.015) +
    xlim(c(0, 250))
```


```{r}
tibble(x, y)
```
